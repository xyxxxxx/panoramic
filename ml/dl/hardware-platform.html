
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="xyx">
      
      
        <link rel="canonical" href="https://xyxxxxx.github.io/panoramic/ml/dl/hardware-platform.html">
      
      
        <link rel="prev" href="../index.html">
      
      
        <link rel="next" href="common-techniques.html">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>硬件平台 - Panoramic</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#硬件平台" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="Panoramic" class="md-header__button md-logo" aria-label="Panoramic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Panoramic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              硬件平台
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../math/index.html" class="md-tabs__link">
          
  
  
    
  
  数学

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../index.html" class="md-tabs__link">
          
  
  
    
  
  机器学习

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../lifestyle/index.html" class="md-tabs__link">
          
  
  
    
  
  生活方式

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Panoramic" class="md-nav__button md-logo" aria-label="Panoramic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Panoramic
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../math/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    数学
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../math/la.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    线性代数
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    机器学习
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            机器学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    深度学习
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            深度学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    硬件平台
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="hardware-platform.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    硬件平台
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#计算性能" class="md-nav__link">
    <span class="md-ellipsis">
      计算性能
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#通信速度" class="md-nav__link">
    <span class="md-ellipsis">
      通信速度
    </span>
  </a>
  
    <nav class="md-nav" aria-label="通信速度">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nccl" class="md-nav__link">
    <span class="md-ellipsis">
      NCCL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmpi" class="md-nav__link">
    <span class="md-ellipsis">
      OpenMPI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gloo" class="md-nav__link">
    <span class="md-ellipsis">
      Gloo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#horovod" class="md-nav__link">
    <span class="md-ellipsis">
      Horovod
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="common-techniques.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    常用技术
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="parallel-strategy-computation-speedup-and-memory-optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    并行策略、计算加速与内存优化技术
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../rl/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    强化学习专题
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            强化学习专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rl/algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    算法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../llm/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    LLM 专题
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            LLM 专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/architecture.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    架构
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/training.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    训练
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    推理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/evaluation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    评估
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/applications.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    应用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm/insights.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    洞见
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../lifestyle/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    生活方式
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            生活方式
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lifestyle/photography.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    摄影
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lifestyle/cooking.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    烹饪
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#计算性能" class="md-nav__link">
    <span class="md-ellipsis">
      计算性能
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#通信速度" class="md-nav__link">
    <span class="md-ellipsis">
      通信速度
    </span>
  </a>
  
    <nav class="md-nav" aria-label="通信速度">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nccl" class="md-nav__link">
    <span class="md-ellipsis">
      NCCL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#openmpi" class="md-nav__link">
    <span class="md-ellipsis">
      OpenMPI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gloo" class="md-nav__link">
    <span class="md-ellipsis">
      Gloo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#horovod" class="md-nav__link">
    <span class="md-ellipsis">
      Horovod
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="硬件平台">硬件平台<a class="headerlink" href="#硬件平台" title="Permanent link">&para;</a></h1>
<p>深度学习计算，尤其是大型模型的并行训练，需要高性能的硬件平台。这里的高性能体现在以下方面：</p>
<ul>
<li>计算性能：尤其是浮点性能，用于模型的前向和反向计算</li>
<li>通信速度：用于并行训练中的设备间通信</li>
<li>内存大小：用于存放模型权重、激活、梯度等数据</li>
<li>存储容量：用于存放模型、数据集等的文件</li>
</ul>
<p>针对深度学习计算进行专门优化的硬件设备和硬件平台正在快速迭代当中。</p>
<h2 id="计算性能">计算性能<a class="headerlink" href="#计算性能" title="Permanent link">&para;</a></h2>
<p>每秒浮点运算次数（floating point operations per second，FLOPS）和每秒整数运算次数（integer operations per second，integer OPS）都是计算性能的度量标准。以 FLOPS 为例，所有单位前缀如下表所示：</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Unit</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Kilo-">kilo</a>FLOPS</td>
<td>kFLOPS</td>
<td>10^3</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Mega-">mega</a>FLOPS</td>
<td>MFLOPS</td>
<td>10^6</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Giga-">giga</a>FLOPS</td>
<td>GFLOPS</td>
<td>10^9</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Tera-">tera</a>FLOPS</td>
<td>TFLOPS</td>
<td>10^12</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Peta-">peta</a>FLOPS</td>
<td>PFLOPS</td>
<td>10^15</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Exa-">exa</a>FLOPS</td>
<td>EFLOPS</td>
<td>10^18</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Zetta-">zetta</a>FLOPS</td>
<td>ZFLOPS</td>
<td>10^21</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Yotta-">yotta</a>FLOPS</td>
<td>YFLOPS</td>
<td>10^24</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Ronna-">ronna</a>FLOPS</td>
<td>RFLOPS</td>
<td>10^27</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/Quetta-">quetta</a>FLOPS</td>
<td>QFLOPS</td>
<td>10^30</td>
</tr>
</tbody>
</table>
<p>主要 NVIDIA GPU 的浮点性能如下表所示，其中 INT8 这一列的单位为 TOPS，其他列的单位为 TFLOPS：</p>
<table>
<thead>
<tr>
<th>GPU</th>
<th>FP64</th>
<th>FP64 Tensor</th>
<th>FP32</th>
<th>TF32</th>
<th>FP16</th>
<th>FP16 Tensor</th>
<th>BF16 Tensor</th>
<th>INT8 Tensor</th>
</tr>
</thead>
<tbody>
<tr>
<td>V100 PCIe</td>
<td>7</td>
<td></td>
<td>14</td>
<td>-</td>
<td>28</td>
<td>112</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>V100 SXM</td>
<td>7.8</td>
<td></td>
<td>15.7</td>
<td>-</td>
<td>31.4</td>
<td>125</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>RTX 3080</td>
<td></td>
<td></td>
<td>29.8</td>
<td></td>
<td>29.8</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>RTX 3090</td>
<td></td>
<td></td>
<td>35.6</td>
<td></td>
<td>35.6</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>A40</td>
<td></td>
<td></td>
<td>37.4</td>
<td>74.8</td>
<td>37.4</td>
<td>149.7</td>
<td>149.7</td>
<td>299.3</td>
</tr>
<tr>
<td>A100</td>
<td>9.7</td>
<td>19.5</td>
<td>19.5</td>
<td>156</td>
<td>78</td>
<td>312</td>
<td>312</td>
<td>624</td>
</tr>
<tr>
<td>RTX 4080</td>
<td></td>
<td></td>
<td>48.7</td>
<td></td>
<td>48.7</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>RTX 4090</td>
<td></td>
<td></td>
<td>82.6</td>
<td></td>
<td>82.6</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>H100 PCIe</td>
<td>26</td>
<td>51</td>
<td>51</td>
<td>756</td>
<td>205</td>
<td>1513</td>
<td>1513</td>
<td>3026</td>
</tr>
<tr>
<td>H100 SXM</td>
<td>34</td>
<td>67</td>
<td>67</td>
<td>989</td>
<td>268</td>
<td>1979</td>
<td>1979</td>
<td>3958</td>
</tr>
</tbody>
</table>
<h2 id="通信速度">通信速度<a class="headerlink" href="#通信速度" title="Permanent link">&para;</a></h2>
<div class="admonition info">
<p class="admonition-title">参考</p>
<ul>
<li><a href="https://www.bilibili.com/video/BV193BBYYEaG">【GPU 互联革命史】PCIe 到 NVLink，再到 NVSwitch 的成长故事 —— 看 GPU 如何推动 AI 与高性能计算！</a></li>
<li><a href="https://www.bilibili.com/video/BV1WokRYrEZw">【RDMA 深度科普】高效通信三剑客：RDMA 与 RoCE、InfiniBand 入门解读！</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/673903240">AI 集群基础设施 InfiniBand 详解</a></li>
</ul>
</div>
<p>在并行训练中，GPU 之间的通信方式决定了通信速度，进而对总体训练时间有重大影响。常见的通信方式如下：</p>
<p>节点内通信：</p>
<ul>
<li>
<p>共享内存：CPU 之间通过共享内存进行通信，速度最快，延迟最低。</p>
</li>
<li>
<p>PCIe（Peripheral Component Interconnect Express）：PCIe 是一种计算机总线标准，用于连接主板上的各种设备，包括 GPU。PCIe 互连提供了一种相对简单和广泛支持的 GPU 间通信方式，但它的带宽相对较低，延迟相对较高，因为数据需要通过主板上的 PCIe 总线进行传输。</p>
<p>标准带宽：</p>
<ul>
<li>PCIe 4.0：31.5GB/s（x16，每个方向）</li>
<li>PCIe 5.0：63.0GB/s（x16，每个方向）</li>
<li>PCIe 6.0：126.0GB/s（x16，每个方向）</li>
</ul>
</li>
</ul>
<p><img alt="" src="https://s2.loli.net/2025/01/01/VPMfcoykmHg9UON.png" /></p>
<ul>
<li>
<p>NVLink：<a href="https://www.nvidia.com/en-us/data-center/nvlink/">NVLink</a> 是一种由 NVIDIA 开发的高速、低延迟的 GPU 间互连技术。NVLink 通过直接连接 GPU 之间的通信通道，可以实现更高的带宽和更低的延迟。相对于 PCIe，NVLink 提供了更快速和更可靠的 GPU 间通信，特别适用于多 GPU 配置下的高性能计算和深度学习任务。</p>
<p>NVSwitch 是 NVLink 的交换机，其提供所有连接到它的 GPU 之间的通信。</p>
<p>标准带宽：（来源：<a href="https://www.nvidia.com/en-us/data-center/nvlink/">NVLink and NVLink Switch</a>）</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>NVLink</th>
<th>Second Generation</th>
<th>Third Generation</th>
<th>Fourth Generation</th>
<th>Fifth Generation</th>
</tr>
</thead>
<tbody>
<tr>
<td>NVLink bandwidth per GPU (bidirectional)</td>
<td>300GB/s</td>
<td>600GB/s</td>
<td>900GB/s</td>
<td>1,800GB/s</td>
</tr>
<tr>
<td>Maximum Number of Links per GPU</td>
<td>6</td>
<td>12</td>
<td>18</td>
<td>18</td>
</tr>
<tr>
<td>Supported NVIDIA Architectures</td>
<td>NVIDIA Volta™ architecture</td>
<td>NVIDIA Ampere architecture</td>
<td>NVIDIA Hopper™ architecture</td>
<td>NVIDIA Blackwell architecture</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>NVSwitch</th>
<th>First Generation</th>
<th>Second Generation</th>
<th>Third Generation</th>
<th>Fourth Generation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Number of GPUs with direct connection within a NVLink domain</td>
<td>Up to 8</td>
<td>Up to 8</td>
<td>Up to 8</td>
<td>Up to 576</td>
</tr>
<tr>
<td>NVSwitch GPU-to-GPU bandwidth (bidirectional)</td>
<td>300GB/s</td>
<td>600GB/s</td>
<td>900GB/s</td>
<td>1,800GB/s</td>
</tr>
<tr>
<td>Total aggregate bandwidth</td>
<td>2.4TB/s</td>
<td>4.8TB/s</td>
<td>7.2TB/s</td>
<td>1PB/s</td>
</tr>
<tr>
<td>Supported NVIDIA architectures</td>
<td>NVIDIA Volta™ architecture</td>
<td>NVIDIA Ampere architecture</td>
<td>NVIDIA Hopper™ architecture</td>
<td>NVIDIA Blackwell architecture</td>
</tr>
</tbody>
</table>
<p><img alt="" src="https://s2.loli.net/2025/01/01/ehGl8F5HtjaDfLS.png" /></p>
<p><img alt="" src="https://www.nvidia.com/content/nvidiaGDC/us/en_US/data-center/nvlink/_jcr_content/root/responsivegrid/nv_container_1813223422/nv_image.coreimg.svg/1710784006566/hopper-grace-gtc24-charts-aggregate-bandwith-nvlink-at-scale.svg" /></p>
<p>节点间通信：</p>
<ul>
<li>
<p>TCP/IP (over Ethernet)：节点之间使用标准的 TCP/IP 协议进行通信，适用于一般的 GPU 间通信需求，尤其在小规模 GPU 集群和一般网络环境中使用。</p>
<p>典型带宽：100Mbps/1Gbps/10Gbps</p>
</li>
</ul>
<p><img alt="" src="https://s2.loli.net/2025/01/01/8Wil3YkUPyQuXrT.png" /></p>
<ul>
<li>RDMA (Remote Direct Memory Access)：RDMA 是一种高性能、低延迟的数据传输技术，它允许应用程序之间直接进行内存访问和数据传输，避免了 CPU 的参与，从而实现了极低的延迟和高带宽的应用间通信。RDMA 适用于对延迟和带宽要求非常高的高性能计算和大规模并行计算任务。</li>
</ul>
<p><img alt="" src="https://s2.loli.net/2025/01/01/LWKs6pM9P2Jhn3I.png" /></p>
<ul>
<li>
<p>InfiniBand（IB）：InfiniBand 是一种用于高性能计算的网络通信标准，它具有极高的带宽和极低的延迟，用于节点之间的数据互连。InfiniBand 专为 RDMA 设计并提供 RDMA 能力，从硬件层面保证可靠传输。搭建 InfiniBand 网络需要专用的 IB 网卡、IB 交换机和 IB 线缆，成本较高。</p>
<div class="highlight"><pre><span></span><code>典型带宽：200Gbps/400Gbps/800Gbps
</code></pre></div>
</li>
<li>
<p>RoCE (RDMA over Converged Ethernet)：以太网上的 RDMA 实现。利用现有的标准以太网基础设施，但需要专用的 RoCE 网卡（HCA，host channel adapter）。</p>
<div class="highlight"><pre><span></span><code>典型带宽：100Gbps/200Gbps/400Gbps
</code></pre></div>
</li>
<li>
<p>GPUDirect RDMA：针对 NVIDIA GPU 的 RDMA 实现，它允许 GPU 和支持 RDMA 的设备（例如 IB/RoCE 网卡、支持 RDMA 的存储设备）之间直接通过 PCIe 总线进行数据传输，而无需经过 CPU 或系统内存。</p>
</li>
</ul>
<p><img alt="" src="../../assets/ml/dl/rdma.png" /></p>
<p>对于同一物理节点上的 GPU，它们之间的连接方式可以通过以下命令获取：</p>
<div class="highlight"><pre><span></span><code>nvidia-smi<span class="w"> </span>topo<span class="w"> </span>-m
</code></pre></div>
<p>例如 sm02 返回：</p>
<div class="highlight"><pre><span></span><code>        GPU0    GPU1    GPU2    GPU3    CPU Affinity    NUMA Affinity   GPU NUMA ID
GPU0     X      SYS     SYS     SYS     0-9,20-29       0               N/A
GPU1    SYS      X      SYS     SYS     0-9,20-29       0               N/A
GPU2    SYS     SYS      X      SYS     10-19,30-39     1               N/A
GPU3    SYS     SYS     SYS      X      10-19,30-39     1               N/A

Legend:

  X    = Self
  SYS  = Connection traversing PCIe as well as the SMP interconnect between NUMA nodes (e.g., QPI/UPI)
  NODE = Connection traversing PCIe as well as the interconnect between PCIe Host Bridges within a NUMA node
  PHB  = Connection traversing PCIe as well as a PCIe Host Bridge (typically the CPU)
  PXB  = Connection traversing multiple PCIe bridges (without traversing the PCIe Host Bridge)
  PIX  = Connection traversing at most a single PCIe bridge
  NV#  = Connection traversing a bonded set of # NVLinks
</code></pre></div>
<p>对于同一物理节点上的 GPU，它们之间的 P2P 带宽和时延可以通过<a href="https://gist.github.com/joshlk/bbb1aca6e70b11d251886baee6423dcb">此基准测试</a>得到。例如 sm02 返回：</p>
<div class="highlight"><pre><span></span><code>[P2P (Peer-to-Peer) GPU Bandwidth Latency Test]
Device: 0, NVIDIA A100-PCIE-40GB, pciBusID: 18, pciDeviceID: 0, pciDomainID:0
Device: 1, NVIDIA A100-PCIE-40GB, pciBusID: 3b, pciDeviceID: 0, pciDomainID:0
Device: 2, NVIDIA A100-PCIE-40GB, pciBusID: 86, pciDeviceID: 0, pciDomainID:0
Device: 3, NVIDIA A100-PCIE-40GB, pciBusID: af, pciDeviceID: 0, pciDomainID:0
Device=0 CAN Access Peer Device=1
Device=0 CAN Access Peer Device=2
Device=0 CAN Access Peer Device=3
Device=1 CAN Access Peer Device=0
Device=1 CAN Access Peer Device=2
Device=1 CAN Access Peer Device=3
Device=2 CAN Access Peer Device=0
Device=2 CAN Access Peer Device=1
Device=2 CAN Access Peer Device=3
Device=3 CAN Access Peer Device=0
Device=3 CAN Access Peer Device=1
Device=3 CAN Access Peer Device=2

***NOTE: In case a device doesn&#39;t have P2P access to other one, it falls back to normal memcopy procedure.
So you can see lesser Bandwidth (GB/s) and unstable Latency (us) in those cases.

P2P Connectivity Matrix
     D\D     0     1     2     3
     0       1     1     1     1
     1       1     1     1     1
     2       1     1     1     1
     3       1     1     1     1
Unidirectional P2P=Disabled Bandwidth Matrix (GB/s)
   D\D     0      1      2      3 
     0 1151.22  10.78  10.78  10.89 
     1  10.73 1160.63  10.71  10.71 
     2  11.02  11.17 1289.79  11.22 
     3  11.09  11.19  11.40 1294.16 
Unidirectional P2P=Enabled Bandwidth (P2P Writes) Matrix (GB/s)
   D\D     0      1      2      3 
     0 1293.26  10.28   8.33   8.52 
     1  10.28 1306.44   7.71   7.69 
     2   7.94   8.72 1304.36  10.28 
     3   7.95   8.15  10.28 1304.02 
Bidirectional P2P=Disabled Bandwidth Matrix (GB/s)
   D\D     0      1      2      3 
     0 1313.65  12.35  15.67  15.78 
     1  12.39 1314.23  15.71  15.82 
     2  15.69  15.73 1315.60  16.09 
     3  15.70  15.80  16.09 1313.40 
Bidirectional P2P=Enabled Bandwidth Matrix (GB/s)
   D\D     0      1      2      3 
     0 1313.82  19.60  16.51  15.93 
     1  19.59 1315.25  15.88  16.11 
     2  16.58  15.98 1314.42  19.68 
     3  16.08  16.12  19.68 1313.65 
P2P=Disabled Latency Matrix (us)
   GPU     0      1      2      3 
     0   2.25  15.80  18.08  18.31 
     1  15.96   2.32  15.05  17.37 
     2  20.15  17.57   2.30  12.26 
     3  11.77  15.19  18.46   2.34 

   CPU     0      1      2      3 
     0   2.87   8.28   7.52   7.53 
     1   8.29   2.81   7.65   7.19 
     2   7.47   7.64   2.48   6.92 
     3   7.59  10.22   7.60   2.59 
P2P=Enabled Latency (P2P Writes) Matrix (us)
   GPU     0      1      2      3 
     0   2.25   1.92   2.00   1.99 
     1   1.92   2.31   1.99   2.02 
     2   2.00   1.99   2.31   1.93 
     3   2.02   1.98   1.91   2.33 

   CPU     0      1      2      3 
     0   2.92   2.31   2.19   2.15 
     1   2.38   2.94   2.16   2.21 
     2   2.22   1.99   2.59   2.31 
     3   2.23   2.03   2.14   2.54 

NOTE: The CUDA Samples are not meant for performance measurements. Results may vary when GPU Boost is enabled.
</code></pre></div>
<p>对于不同物理节点上的 GPU，它们之间的连接方式……</p>
<h3 id="nccl">NCCL<a class="headerlink" href="#nccl" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/NVIDIA/nccl">NCCL</a>（NVIDIA Collective Communications Library）是一个库，其提供了面向拓扑感知的 GPU 间通信原语，并可以轻松集成到应用程序中。NCCL 实现了集合通信和 P2P（点对点）发送/接收原语。它不是一个完整的并行编程框架，而是一个专注于加速 GPU 间通信的库。</p>
<p>NCCL 提供以下集合通信原语：</p>
<ul>
<li>AllReduce</li>
<li>Broadcast</li>
<li>Reduce</li>
<li>AllGather</li>
<li>ReduceScatter</li>
</ul>
<p>此外，它还支持 P2P 的发送/接收通信，可以实现 Scatter、Gather 或 All-to-All 操作。</p>
<p><img alt="" src="https://s2.loli.net/2025/01/13/WdBD3j7geimpSVU.png" /></p>
<p>NCCL 方便地消除了开发人员针对特定机器进行应用程序优化的需求。NCCL 可以在节点内和节点间的多个 GPU 之间提供快速的集合通信。它支持多种互连技术，包括 PCIe、NVLink、InfiniBand Verbs 和 IP sockets。</p>
<p>NCCL 提供了一组有特定功能的环境变量：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 指定 NCCL 通信算法</span>
<span class="c1"># Ring：GPU 0 ─→ GPU 1 ─→ GPU 2 ─→ GPU 3</span>
<span class="c1">#        ↑                           ↓</span>
<span class="c1">#        └───────────── ←────────────┘</span>
<span class="c1"># 构建多个环路以充分利用带宽</span>
<span class="c1"># 延迟随 GPU 数量线性增长</span>
<span class="c1"># 瓶颈在于最慢的连接，例如跨 NUMA 节点的连接、跨节点的网络连接</span>
<span class="c1"># 可以用于测量真实的网络带宽</span>
<span class="c1">#</span>
<span class="c1"># Tree：     GPU 0</span>
<span class="c1">#       ╱            ╲</span>
<span class="c1">#    GPU 1          GPU 2</span>
<span class="c1">#    ╱   ╲          ╱   ╲</span>
<span class="c1"># GPU 3  GPU 4   GPU 5  GPU 6</span>
<span class="c1"># 采用双二叉树算法，请参阅 https://www.bilibili.com/video/BV1DErsYwEhc</span>
<span class="c1"># 延迟随 GPU 数量对数增长</span>
<span class="c1"># 瓶颈在于负载最重的根节点</span>
<span class="c1">#</span>
<span class="c1"># CollnetDirect：</span>
<span class="c1"># CollnetChain：</span>
<span class="c1"># NVLS：</span>
<span class="c1"># NVLSTree：</span>
<span class="nv">NCCL_ALGO</span><span class="o">=</span>Tree/Ring/CollnetDirect/CollnetChain/NVLS/NVLSTree

<span class="c1"># 启用 COLLNET</span>
<span class="nv">NCCL_COLLNET_ENABLE</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># 指定 NCCL 配置文件</span>
<span class="nv">NCCL_CONF_FILE</span><span class="o">=</span>~/.nccl.conf

<span class="c1"># 控制打印的调试信息</span>
<span class="nv">NCCL_DEBUG</span><span class="o">=</span>VERSION/WARN/INFO/TRACE

<span class="c1"># 重定向 NCCL 调试日志输出到指定文件</span>
<span class="c1"># 若不设置此环境变量，则默认重定向到 stdout</span>
<span class="nv">NCCL_DEBUG_FILE</span><span class="o">=</span>/path/to/debug.log

<span class="c1"># 强制启用或禁用 GPU Direct RDMA</span>
<span class="c1"># 默认会在拓扑允许的情况下启用 GPU Direct RDMA</span>
<span class="nv">NCCL_IB_CUDA_SUPPORT</span><span class="o">=</span><span class="m">0</span>/1

<span class="c1"># 禁用 InfiniBand 传输，强制使用 IP socket 传输</span>
<span class="nv">NCCL_IB_DISABLE</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># 指定 RoCE 模式下的 GID 索引</span>
<span class="nv">NCCL_IB_GID_INDEX</span><span class="o">=</span>-1

<span class="c1"># 指定使用的 InfiniBand/RoCE 网卡</span>
<span class="c1"># 网卡越多，节点间通信带宽越大</span>
<span class="nv">NCCL_IB_HCA</span><span class="o">=</span>mlx5_0

<span class="c1"># 指定 InfiniBand Verbs 的超时时间</span>
<span class="c1"># 设为最大值 31，以减少 nccl timeout 异常</span>
<span class="nv">NCCL_IB_TIMEOUT</span><span class="o">=</span><span class="m">31</span>

<span class="c1"># 精细控制何时在 GPU 和 NIC 之间使用 GPU Direct RDMA</span>
<span class="c1"># LOC：不使用 GPU Direct RDMA（始终禁用）</span>
<span class="c1"># PIX：当 GPU 和 NIC 在同一个 PCI 交换机上时使用 GPU Direct RDMA</span>
<span class="c1"># PXB：当 GPU 和 NIC 通过 PCI 交换机连接时使用 GPU Direct RDMA（可能经过多个跳转）</span>
<span class="c1"># PHB：当 GPU 和 NIC 在同一个 NUMA 节点上时使用 GPU Direct RDMA，流量将通过 CPU</span>
<span class="c1"># SYS：即使跨越 NUMA 节点之间的 SMP 互联（如 QPI/UPI）也使用 GPU Direct RDMA（始终启用）</span>
<span class="nv">NCCL_NET_GDR_LEVEL</span><span class="o">=</span>LOC/PIX/PXB/PHB/SYS

<span class="c1"># 禁用 GPU 之间通过 NVLink 或 PCI 进行 CUDA 直接访问</span>
<span class="nv">NCCL_P2P_DISABLE</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># 精细控制何时使用 P2P 通信</span>
<span class="c1"># 某些软硬件配置可能不支持 P2P 通信</span>
<span class="c1"># LOC：不使用 P2P（始终禁用）</span>
<span class="c1"># NVL：当 GPU 通过 NVLink 连接时使用 P2P</span>
<span class="c1"># PIX：当 GPU 在同一个 PCI 交换机上时使用 P2P</span>
<span class="c1"># PXB：当 GPU 通过 PCI 交换机连接时使用 P2P（可能经过多个跳转）</span>
<span class="c1"># PHB：当 GPU 在同一个 NUMA 节点上时使用 P2P，流量将通过 CPU</span>
<span class="c1"># SYS：即使跨越 NUMA 节点之间的 SMP 互联（如 QPI/UPI）也使用 P2P（始终启用）</span>
<span class="nv">NCCL_P2P_LEVEL</span><span class="o">=</span>LOC/NVL/PIX/PXB/PHB/SYS

<span class="c1"># 禁用 SHM 通信</span>
<span class="c1"># SHM 的通信速度介于 P2P 和 NET 之间；SHM 是 P2P 的备选方案，NET 是 SHM 的备选方案</span>
<span class="nv">NCCL_SHM_DISABLE</span><span class="o">=</span><span class="m">1</span>

<span class="c1"># 指定使用的 socket 网卡</span>
<span class="nv">NCCL_SOCKET_IFNAME</span><span class="o">=</span>eth0

<span class="c1"># 指定要加载的 XML 文件</span>
<span class="nv">NCCL_TOPO_FILE</span><span class="o">=</span>/path/to/topo.xml

<span class="c1"># 将检测到的拓扑保存到指定文件</span>
<span class="nv">NCCL_TOPO_DUMP_FILE</span><span class="o">=</span>/path/to/topo-dump.xml
</code></pre></div>
<p>GPU 之间的集合通信带宽和时延可以通过 <a href="https://github.com/NVIDIA/nccl-tests">nccl-tests</a> 得到。例如对于 sm02：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>all_reduce_perf<span class="w"> </span>-b<span class="w"> </span><span class="m">8</span><span class="w"> </span>-e<span class="w"> </span>128M<span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>-g<span class="w"> </span><span class="m">4</span>
<span class="c1"># nThread 1 nGpus 4 minBytes 8 maxBytes 134217728 step: 2(factor) warmup iters: 5 iters: 20 agg iters: 1 validation: 1 graph: 0</span>
<span class="c1">#</span>
<span class="c1"># Using devices</span>
<span class="c1">#  Rank  0 Group  0 Pid     19 on  nccl-test device  0 [0x18] NVIDIA A100-PCIE-40GB</span>
<span class="c1">#  Rank  1 Group  0 Pid     19 on  nccl-test device  1 [0x3b] NVIDIA A100-PCIE-40GB</span>
<span class="c1">#  Rank  2 Group  0 Pid     19 on  nccl-test device  2 [0x86] NVIDIA A100-PCIE-40GB</span>
<span class="c1">#  Rank  3 Group  0 Pid     19 on  nccl-test device  3 [0xaf] NVIDIA A100-PCIE-40GB</span>
<span class="c1">#</span>
<span class="c1">#                                                              out-of-place                       in-place          </span>
<span class="c1">#       size         count      type   redop    root     time   algbw   busbw #wrong     time   algbw   busbw #wrong</span>
<span class="c1">#        (B)    (elements)                               (us)  (GB/s)  (GB/s)            (us)  (GB/s)  (GB/s)       </span>
<span class="w">           </span><span class="m">8</span><span class="w">             </span><span class="m">2</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">23</span>.43<span class="w">    </span><span class="m">0</span>.00<span class="w">    </span><span class="m">0</span>.00<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">23</span>.11<span class="w">    </span><span class="m">0</span>.00<span class="w">    </span><span class="m">0</span>.00<span class="w">      </span><span class="m">0</span>
<span class="w">          </span><span class="m">16</span><span class="w">             </span><span class="m">4</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">23</span>.00<span class="w">    </span><span class="m">0</span>.00<span class="w">    </span><span class="m">0</span>.00<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">22</span>.90<span class="w">    </span><span class="m">0</span>.00<span class="w">    </span><span class="m">0</span>.00<span class="w">      </span><span class="m">0</span>
<span class="w">          </span><span class="m">32</span><span class="w">             </span><span class="m">8</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">22</span>.92<span class="w">    </span><span class="m">0</span>.00<span class="w">    </span><span class="m">0</span>.00<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">22</span>.77<span class="w">    </span><span class="m">0</span>.00<span class="w">    </span><span class="m">0</span>.00<span class="w">      </span><span class="m">0</span>
<span class="w">          </span><span class="m">64</span><span class="w">            </span><span class="m">16</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">23</span>.34<span class="w">    </span><span class="m">0</span>.00<span class="w">    </span><span class="m">0</span>.00<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">22</span>.69<span class="w">    </span><span class="m">0</span>.00<span class="w">    </span><span class="m">0</span>.00<span class="w">      </span><span class="m">0</span>
<span class="w">         </span><span class="m">128</span><span class="w">            </span><span class="m">32</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">23</span>.15<span class="w">    </span><span class="m">0</span>.01<span class="w">    </span><span class="m">0</span>.01<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">23</span>.09<span class="w">    </span><span class="m">0</span>.01<span class="w">    </span><span class="m">0</span>.01<span class="w">      </span><span class="m">0</span>
<span class="w">         </span><span class="m">256</span><span class="w">            </span><span class="m">64</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">23</span>.13<span class="w">    </span><span class="m">0</span>.01<span class="w">    </span><span class="m">0</span>.02<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">22</span>.80<span class="w">    </span><span class="m">0</span>.01<span class="w">    </span><span class="m">0</span>.02<span class="w">      </span><span class="m">0</span>
<span class="w">         </span><span class="m">512</span><span class="w">           </span><span class="m">128</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">23</span>.26<span class="w">    </span><span class="m">0</span>.02<span class="w">    </span><span class="m">0</span>.03<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">23</span>.74<span class="w">    </span><span class="m">0</span>.02<span class="w">    </span><span class="m">0</span>.03<span class="w">      </span><span class="m">0</span>
<span class="w">        </span><span class="m">1024</span><span class="w">           </span><span class="m">256</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">23</span>.25<span class="w">    </span><span class="m">0</span>.04<span class="w">    </span><span class="m">0</span>.07<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">23</span>.57<span class="w">    </span><span class="m">0</span>.04<span class="w">    </span><span class="m">0</span>.07<span class="w">      </span><span class="m">0</span>
<span class="w">        </span><span class="m">2048</span><span class="w">           </span><span class="m">512</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">23</span>.73<span class="w">    </span><span class="m">0</span>.09<span class="w">    </span><span class="m">0</span>.13<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">23</span>.46<span class="w">    </span><span class="m">0</span>.09<span class="w">    </span><span class="m">0</span>.13<span class="w">      </span><span class="m">0</span>
<span class="w">        </span><span class="m">4096</span><span class="w">          </span><span class="m">1024</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">23</span>.92<span class="w">    </span><span class="m">0</span>.17<span class="w">    </span><span class="m">0</span>.26<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">23</span>.64<span class="w">    </span><span class="m">0</span>.17<span class="w">    </span><span class="m">0</span>.26<span class="w">      </span><span class="m">0</span>
<span class="w">        </span><span class="m">8192</span><span class="w">          </span><span class="m">2048</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">24</span>.78<span class="w">    </span><span class="m">0</span>.33<span class="w">    </span><span class="m">0</span>.50<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">24</span>.38<span class="w">    </span><span class="m">0</span>.34<span class="w">    </span><span class="m">0</span>.50<span class="w">      </span><span class="m">0</span>
<span class="w">       </span><span class="m">16384</span><span class="w">          </span><span class="m">4096</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">30</span>.66<span class="w">    </span><span class="m">0</span>.53<span class="w">    </span><span class="m">0</span>.80<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">30</span>.48<span class="w">    </span><span class="m">0</span>.54<span class="w">    </span><span class="m">0</span>.81<span class="w">      </span><span class="m">0</span>
<span class="w">       </span><span class="m">32768</span><span class="w">          </span><span class="m">8192</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">36</span>.45<span class="w">    </span><span class="m">0</span>.90<span class="w">    </span><span class="m">1</span>.35<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">35</span>.93<span class="w">    </span><span class="m">0</span>.91<span class="w">    </span><span class="m">1</span>.37<span class="w">      </span><span class="m">0</span>
<span class="w">       </span><span class="m">65536</span><span class="w">         </span><span class="m">16384</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">54</span>.10<span class="w">    </span><span class="m">1</span>.21<span class="w">    </span><span class="m">1</span>.82<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">54</span>.40<span class="w">    </span><span class="m">1</span>.20<span class="w">    </span><span class="m">1</span>.81<span class="w">      </span><span class="m">0</span>
<span class="w">      </span><span class="m">131072</span><span class="w">         </span><span class="m">32768</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">86</span>.34<span class="w">    </span><span class="m">1</span>.52<span class="w">    </span><span class="m">2</span>.28<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">85</span>.72<span class="w">    </span><span class="m">1</span>.53<span class="w">    </span><span class="m">2</span>.29<span class="w">      </span><span class="m">0</span>
<span class="w">      </span><span class="m">262144</span><span class="w">         </span><span class="m">65536</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">123</span>.5<span class="w">    </span><span class="m">2</span>.12<span class="w">    </span><span class="m">3</span>.18<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">122</span>.6<span class="w">    </span><span class="m">2</span>.14<span class="w">    </span><span class="m">3</span>.21<span class="w">      </span><span class="m">0</span>
<span class="w">      </span><span class="m">524288</span><span class="w">        </span><span class="m">131072</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">191</span>.3<span class="w">    </span><span class="m">2</span>.74<span class="w">    </span><span class="m">4</span>.11<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">187</span>.5<span class="w">    </span><span class="m">2</span>.80<span class="w">    </span><span class="m">4</span>.19<span class="w">      </span><span class="m">0</span>
<span class="w">     </span><span class="m">1048576</span><span class="w">        </span><span class="m">262144</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">316</span>.8<span class="w">    </span><span class="m">3</span>.31<span class="w">    </span><span class="m">4</span>.96<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">307</span>.6<span class="w">    </span><span class="m">3</span>.41<span class="w">    </span><span class="m">5</span>.11<span class="w">      </span><span class="m">0</span>
<span class="w">     </span><span class="m">2097152</span><span class="w">        </span><span class="m">524288</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">546</span>.8<span class="w">    </span><span class="m">3</span>.84<span class="w">    </span><span class="m">5</span>.75<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">631</span>.6<span class="w">    </span><span class="m">3</span>.32<span class="w">    </span><span class="m">4</span>.98<span class="w">      </span><span class="m">0</span>
<span class="w">     </span><span class="m">4194304</span><span class="w">       </span><span class="m">1048576</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">   </span><span class="m">1372</span>.4<span class="w">    </span><span class="m">3</span>.06<span class="w">    </span><span class="m">4</span>.58<span class="w">      </span><span class="m">0</span><span class="w">   </span><span class="m">1255</span>.0<span class="w">    </span><span class="m">3</span>.34<span class="w">    </span><span class="m">5</span>.01<span class="w">      </span><span class="m">0</span>
<span class="w">     </span><span class="m">8388608</span><span class="w">       </span><span class="m">2097152</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">   </span><span class="m">2263</span>.7<span class="w">    </span><span class="m">3</span>.71<span class="w">    </span><span class="m">5</span>.56<span class="w">      </span><span class="m">0</span><span class="w">   </span><span class="m">2449</span>.5<span class="w">    </span><span class="m">3</span>.42<span class="w">    </span><span class="m">5</span>.14<span class="w">      </span><span class="m">0</span>
<span class="w">    </span><span class="m">16777216</span><span class="w">       </span><span class="m">4194304</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">   </span><span class="m">5214</span>.7<span class="w">    </span><span class="m">3</span>.22<span class="w">    </span><span class="m">4</span>.83<span class="w">      </span><span class="m">0</span><span class="w">   </span><span class="m">4979</span>.8<span class="w">    </span><span class="m">3</span>.37<span class="w">    </span><span class="m">5</span>.05<span class="w">      </span><span class="m">0</span>
<span class="w">    </span><span class="m">33554432</span><span class="w">       </span><span class="m">8388608</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">11398</span><span class="w">    </span><span class="m">2</span>.94<span class="w">    </span><span class="m">4</span>.42<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">12808</span><span class="w">    </span><span class="m">2</span>.62<span class="w">    </span><span class="m">3</span>.93<span class="w">      </span><span class="m">0</span>
<span class="w">    </span><span class="m">67108864</span><span class="w">      </span><span class="m">16777216</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">18726</span><span class="w">    </span><span class="m">3</span>.58<span class="w">    </span><span class="m">5</span>.38<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">18558</span><span class="w">    </span><span class="m">3</span>.62<span class="w">    </span><span class="m">5</span>.42<span class="w">      </span><span class="m">0</span>
<span class="w">   </span><span class="m">134217728</span><span class="w">      </span><span class="m">33554432</span><span class="w">     </span>float<span class="w">     </span>sum<span class="w">      </span>-1<span class="w">    </span><span class="m">38693</span><span class="w">    </span><span class="m">3</span>.47<span class="w">    </span><span class="m">5</span>.20<span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">40147</span><span class="w">    </span><span class="m">3</span>.34<span class="w">    </span><span class="m">5</span>.01<span class="w">      </span><span class="m">0</span>
<span class="c1"># Out of bounds values : 0 OK</span>
<span class="c1"># Avg bus bandwidth    : 2.19202 </span>
<span class="c1">#</span>
</code></pre></div>
<h3 id="openmpi">OpenMPI<a class="headerlink" href="#openmpi" title="Permanent link">&para;</a></h3>
<h3 id="gloo">Gloo<a class="headerlink" href="#gloo" title="Permanent link">&para;</a></h3>
<h3 id="horovod">Horovod<a class="headerlink" href="#horovod" title="Permanent link">&para;</a></h3>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    2025-04-27
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "navigation.tabs", "navigation.top", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/tex-mml-chtml.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.cs/net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>